{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file://D%3A/Mitos/admin/src/app/admin/blocks/page.jsx"],"sourcesContent":["\"use client\";\r\nimport { useEffect, useState } from \"react\";\r\nimport {\r\n  fetchPortions,\r\n  fetchSubjectsByPortions,\r\n  fetchChaptersBySubject,\r\n  fetchChapterTopics,\r\n  updateBlockStatus,\r\n} from \"@/api/admin/api\"; // Adjust import path if needed\r\n\r\nconst BlockContentPage = () => {\r\n  const [portions, setPortions] = useState([]);\r\n  const [selectedPortion, setSelectedPortion] = useState(null);\r\n  const [subjects, setSubjects] = useState([]);\r\n  const [chapters, setChapters] = useState([]);\r\n  const [topics, setTopics] = useState([]);\r\n  const [loading, setLoading] = useState(false);\r\n\r\n  useEffect(() => {\r\n    fetchPortions().then(setPortions);\r\n  }, []);\r\n\r\n  const handlePortionSelect = async (portionId) => {\r\n    setSelectedPortion(portionId);\r\n    const subs = await fetchSubjectsByPortions(portionId);\r\n    setSubjects(subs);\r\n    setChapters([]);\r\n    setTopics([]);\r\n  };\r\n\r\n  const handleSubjectSelect = async (subjectId) => {\r\n    const chaps = await fetchChaptersBySubject(subjectId);\r\n    setChapters(chaps);\r\n    setTopics([]);\r\n  };\r\n\r\n  const handleChapterSelect = async (chapterId) => {\r\n    const tops = await fetchChapterTopics(chapterId);\r\n    setTopics(tops);\r\n  };\r\n\r\n  const toggleBlock = async (type, id, currentState) => {\r\n    try {\r\n      setLoading(true);\r\n      await updateBlockStatus(type, id, !currentState);\r\n      // Refresh the data\r\n      if (type === \"portion\") fetchPortions().then(setPortions);\r\n      if (type === \"subject\") handlePortionSelect(selectedPortion);\r\n      if (type === \"chapter\") handleSubjectSelect(subjects.find(s => s.id === id)?.id);\r\n      if (type === \"topic\") handleChapterSelect(chapters.find(c => c.id === id)?.id);\r\n    } catch (error) {\r\n      console.error(\"Toggle error:\", error);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"p-6\">\r\n      <h2 className=\"text-2xl font-bold mb-4\">Block/Unblock Content</h2>\r\n\r\n      <div className=\"mb-6\">\r\n        <label className=\"font-medium\">Select Portion:</label>\r\n        <select\r\n          onChange={(e) => handlePortionSelect(Number(e.target.value))}\r\n          className=\"border ml-2 px-2 py-1\"\r\n        >\r\n          <option value=\"\">--Select--</option>\r\n          {portions.map((p) => (\r\n            <option key={p.id} value={p.id}>\r\n              {p.name}\r\n            </option>\r\n          ))}\r\n        </select>\r\n      </div>\r\n\r\n      {portions.length > 0 && (\r\n        <div className=\"mb-4\">\r\n          <h3 className=\"font-semibold\">Portions</h3>\r\n          {portions.map((p) => (\r\n            <BlockItem\r\n              key={p.id}\r\n              label={p.name}\r\n              isPremium={p.isPremium}\r\n              onToggle={() => toggleBlock(\"portion\", p.id, p.isPremium)}\r\n            />\r\n          ))}\r\n        </div>\r\n      )}\r\n\r\n      {subjects.length > 0 && (\r\n        <div className=\"mb-4\">\r\n          <h3 className=\"font-semibold\">Subjects</h3>\r\n          {subjects.map((s) => (\r\n            <div key={s.id}>\r\n              <BlockItem\r\n                label={s.name}\r\n                isPremium={s.isPremium}\r\n                onToggle={() => toggleBlock(\"subject\", s.id, s.isPremium)}\r\n              />\r\n              <button\r\n                onClick={() => handleSubjectSelect(s.id)}\r\n                className=\"text-sm text-blue-600 underline ml-2\"\r\n              >\r\n                Load Chapters\r\n              </button>\r\n            </div>\r\n          ))}\r\n        </div>\r\n      )}\r\n\r\n      {chapters.length > 0 && (\r\n        <div className=\"mb-4\">\r\n          <h3 className=\"font-semibold\">Chapters</h3>\r\n          {chapters.map((c) => (\r\n            <div key={c.id}>\r\n              <BlockItem\r\n                label={c.name}\r\n                isPremium={c.isPremium}\r\n                onToggle={() => toggleBlock(\"chapter\", c.id, c.isPremium)}\r\n              />\r\n              <button\r\n                onClick={() => handleChapterSelect(c.id)}\r\n                className=\"text-sm text-blue-600 underline ml-2\"\r\n              >\r\n                Load Topics\r\n              </button>\r\n            </div>\r\n          ))}\r\n        </div>\r\n      )}\r\n\r\n      {topics.length > 0 && (\r\n        <div>\r\n          <h3 className=\"font-semibold\">Topics</h3>\r\n          {topics.map((t) => (\r\n            <BlockItem\r\n              key={t.id}\r\n              label={t.name}\r\n              isPremium={t.isPremium}\r\n              onToggle={() => toggleBlock(\"topic\", t.id, t.isPremium)}\r\n            />\r\n          ))}\r\n        </div>\r\n      )}\r\n\r\n      {loading && <p className=\"text-sm text-gray-500 mt-4\">Updating...</p>}\r\n    </div>\r\n  );\r\n};\r\n\r\nconst BlockItem = ({ label, isPremium, onToggle }) => (\r\n  <div className=\"flex items-center gap-4 py-1\">\r\n    <span>{label}</span>\r\n    <button\r\n      onClick={onToggle}\r\n      className={`px-3 py-1 text-sm rounded ${\r\n        isPremium ? \"bg-red-500 text-white\" : \"bg-green-500 text-white\"\r\n      }`}\r\n    >\r\n      {isPremium ? \"Blocked (Premium)\" : \"Unblocked (Free)\"}\r\n    </button>\r\n  </div>\r\n);\r\n\r\nexport default BlockContentPage;\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 307, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}}]
}